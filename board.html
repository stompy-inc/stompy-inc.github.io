<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>board</title>
    <style>
    	body {
            margin: 0;
            overflow: hidden;
            position: relative;
            width: 100vw;
            height: 100vh;
        }
        img.draggable {
            position: absolute;
            cursor: pointer;
            transition: 0.2s;
            border: 2px solid transparent;
        }
        img.selected {
            border: 2px solid blue;
        }
        img.clone {
            opacity: 0.5;
            pointer-events: none;
        }
        
	    textarea{
	    	position:absolute;
	    	top:40px;
	    	background:none;
	    	border:none;
	    	color:deeppink;
	    	font-weight:bold;
	    	width:27px;
	    	height:700px;
	    	font-size:25px;
	    	-webkit-text-stroke: 1px #FFF;
	    	font-family: sans-serif;
	    	overflow:hidden;
	    	writing-mode: vertical-rl;
	    	text-orientation: upright;
	    	line-height: 90%;
	    }
    </style>
</head>
<body style="overflow:hidden;background:#4c4a48;">
    
    <div style="padding:5px">
		<button id="fullscreenBtn">ğŸ’»</button>
	    <script>
	    	//ãƒ•ãƒ«ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ãƒœã‚¿ãƒ³ã®å‡¦ç†
		    const fullscreenBtn = document.getElementById('fullscreenBtn');
			// ãƒœã‚¿ãƒ³ã®ã‚¯ãƒªãƒƒã‚¯ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ã‚’è¿½åŠ 
			fullscreenBtn.addEventListener('click', function() {
			    if (!document.fullscreenElement) {
			        // å…¨ç”»é¢è¡¨ç¤ºãŒæœ‰åŠ¹ã§ãªã„å ´åˆã€å…¨ç”»é¢è¡¨ç¤ºã‚’æœ‰åŠ¹ã«ã™ã‚‹
			        if (document.documentElement.requestFullscreen) {
			            document.documentElement.requestFullscreen();
			        } else if (document.documentElement.mozRequestFullScreen) { /* Firefox */
			            document.documentElement.mozRequestFullScreen();
			        } else if (document.documentElement.webkitRequestFullscreen) { /* Chrome, Safari and Opera */
			            document.documentElement.webkitRequestFullscreen();
			        } else if (document.documentElement.msRequestFullscreen) { /* IE/Edge */
			            document.documentElement.msRequestFullscreen();
			        }
			    } else {
			        // ã™ã§ã«å…¨ç”»é¢è¡¨ç¤ºãŒæœ‰åŠ¹ã®å ´åˆã€å…¨ç”»é¢è¡¨ç¤ºã‚’çµ‚äº†ã™ã‚‹
			        if (document.exitFullscreen) {
			            document.exitFullscreen();
			        } else if (document.mozCancelFullScreen) { /* Firefox */
			            document.mozCancelFullScreen();
			        } else if (document.webkitExitFullscreen) { /* Chrome, Safari and Opera */
			            document.webkitExitFullscreen();
			        } else if (document.msExitFullscreen) { /* IE/Edge */
			            document.msExitFullscreen();
			        }
			    }
			});
	    </script>
		<!-- æ—¢å­˜ã®ãƒ•ã‚¡ã‚¤ãƒ«å…¥åŠ›ã‚’ "hidden" ã‚¯ãƒ©ã‚¹ã§éš ã™ -->
		<input type="file" id="fileInput" style="display:none;">
		<!-- ã‚«ã‚¹ã‚¿ãƒ ã®ãƒœã‚¿ãƒ³ã¨ãƒ©ãƒ™ãƒ«ã‚’è¿½åŠ  -->
		<button id="customUploadBtn">ğŸ¨</button>
	    <script>
	    	//ãƒ–ãƒ©ã‚¦ã‚¶æ¨™æº–ã®ãƒœã‚¿ãƒ³ã‚’éš ã—ã¦ã€ç”¨æ„ã—ãŸã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ãƒœã‚¿ãƒ³ã‚’ç¨¼åƒã•ã›ã‚‹ã€‚
			const customUploadBtn = document.getElementById('customUploadBtn');
			// ã‚«ã‚¹ã‚¿ãƒ ãƒœã‚¿ãƒ³ãŒã‚¯ãƒªãƒƒã‚¯ã•ã‚ŒãŸã¨ãã«éš ã‚Œã¦ã„ã‚‹inputã‚’ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹
			customUploadBtn.addEventListener('click', function() {
			    fileInput.click();
			});
	    </script>
	</div>
	
    <script>
        let selectedImage = null;
        let clone = null;
        
		var id_count = 0;
		var z_index_count = 0;//é‡ãªã‚Šé †ã‚’ç®¡ç†ã™ã‚‹
        
        document.getElementById('fileInput').addEventListener('change', function(e) {
            const files = e.target.files;

            for (let file of files) {
                const reader = new FileReader();

                reader.onload = function(event) {
                	
                    const img = new Image();
                    img.src = event.target.result;
                    img.classList.add('draggable');

                    img.onload = function() {
                    	id_count = id_count + 1;
                    	img.id = "img_" + String(id_count);//ç”»åƒã«idä»˜ä¸
                        img.style.left = "0px";
                        img.style.top = "0px";
                        document.body.appendChild(img);
                        addControlButtons(img); // ãƒœã‚¿ãƒ³ã®è¿½åŠ é–¢æ•°ã‚’å‘¼ã³å‡ºã—
                    }
                };

                reader.readAsDataURL(file);
            }
            e.target.value = '';

        });
        
		let offsetX, offsetY;
		
		document.body.addEventListener('click', function(e) {
		    if (selectedImage && clone) {
		    	
		    	z_index_count = z_index_count + 1;
		    	
		        selectedImage.style.left = clone.style.left;
		        selectedImage.style.top = clone.style.top;
		        
		        selectedImage.style.zIndex = String(z_index_count);
		        //ãƒœã‚¿ãƒ³ã‚‚ç§»å‹•ã•ã›ã‚‹
		        document.getElementById('btn_' + selectedImage.id).style.left = clone.style.left;
		        document.getElementById('btn_' + selectedImage.id).style.top = clone.style.top;
		        document.getElementById('btn_' + selectedImage.id).style.zIndex = String(z_index_count);
		        
		        //
		        selectedImage.classList.remove('selected');
		        clone.remove();
		        clone = null;
		        selectedImage = null;
		    } else if (e.target.classList.contains('draggable')) {
		        if (selectedImage) {
		            selectedImage.classList.remove('selected');
		            if (clone) {
		                clone.remove();
		                clone = null;
		            }
		        }
		        selectedImage = e.target;
		        selectedImage.classList.add('selected');
		
				if (clone == null){
		        clone = selectedImage.cloneNode(true);
		        clone.style.left = selectedImage.style.left;
		        clone.style.top = selectedImage.style.top;
		        clone.classList.add('clone');
		        document.body.appendChild(clone);
		
		        // ã‚¯ãƒ­ãƒ¼ãƒ³ã¨ãƒã‚¦ã‚¹ãƒã‚¤ãƒ³ã‚¿ã®ã‚ªãƒ•ã‚»ãƒƒãƒˆã‚’ä¿å­˜
		        offsetX = e.clientX - clone.getBoundingClientRect().left;
		        offsetY = e.clientY - clone.getBoundingClientRect().top;
		       }
		    }
		    
		    
		});
		
		document.body.addEventListener('mousemove', function(e) {
		    if (clone) {
		        clone.style.left = (e.clientX - offsetX) + 'px';
		        clone.style.top = (e.clientY - offsetY) + 'px';
		    }
		});

    </script>
    
    <script>
    	// ç”»åƒã«å¯¾ã—ã¦ãƒœã‚¿ãƒ³ã‚’è¿½åŠ ã™ã‚‹é–¢æ•°
		function addControlButtons(img) {
		    let enlargeBtn = createButton("+");
		    let reduceBtn = createButton("-");
		    let hideBtn = createButton("x");
		
		    enlargeBtn.addEventListener('click', function() {
		        img.width *= 1.1;
		    });
		
		    reduceBtn.addEventListener('click', function() {
		        img.width *= 0.9;
		    });
		
		    hideBtn.addEventListener('click', function() {
		        img.style.display = "none";
		        document.getElementById('btn_' + img.id).style.display = "none";//ãƒœã‚¿ãƒ³é¡ã‚‚æ¶ˆã™
		    });
		
		    let btnGroup = document.createElement('div');
		    btnGroup.id = "btn_img_" + String(id_count);//ãƒœã‚¿ãƒ³ã‚’ç”»åƒã«è¿½å¾“ã•ã›ã‚‹ãŸã‚ã€idã‚’ä»˜ä¸
		    btnGroup.style.position = "absolute";
		    btnGroup.style.left = img.style.left;
		    btnGroup.style.top = img.style.top;
		    
		    btnGroup.appendChild(enlargeBtn);
		    btnGroup.appendChild(reduceBtn);
		    btnGroup.appendChild(hideBtn);
		
		
			let txtArea1 = document.createElement('textarea');
			txtArea1.style.left = "10px";
		    btnGroup.appendChild(txtArea1);
			let txtArea2 = document.createElement('textarea');
		    txtArea2.style.left = "42px";
		    btnGroup.appendChild(txtArea2);
		    
		    document.body.appendChild(btnGroup);
		    
		}
		
		// ãƒœã‚¿ãƒ³ã‚’ä½œæˆã™ã‚‹é–¢æ•°
		function createButton(text) {
		    let btn = document.createElement('button');
		    btn.innerText = text;
		    btn.style.marginRight = "2px";
		    return btn;
		}
    </script>
</body>
</html>
